import { create } from "zustand";
import { createJSONStorage, persist } from "zustand/middleware";
import { toast } from "sonner";
import { Transaction } from "@/types";

interface TransactionType {
  transactions: Transaction[];
  setTransactions: (data: Transaction[]) => void;
  addTransaction: (data: Transaction) => void;
  deleteTransaction: (id: number) => void;
  clearAll: () => void;
}

const useTransaction = create(
  persist<TransactionType>(
    (set, get) => ({
      transactions: [
        {
          id: 1,
          userid: "2",
          sender: "2",
          senderName: "Suraj Muhammad",
          senderPic: "",
          receiver: "user2",
          receiverName: "Salma Gambo",
          receiverPic: "",
          amount: 5000,
          refid: "TXN001",
          narration: "Payment for services",
          date: "2024-09-05T10:00:00.000Z",
          createdAt: "2024-09-05T10:00:00.000Z",
          updatedAt: "2024-09-05T10:00:00.000Z",
          isCredit: false,
        },
        {
          id: 2,
          userid: "2",
          sender: "user3",
          senderName: "Muhammad Ali",
          senderPic: "",
          receiver: "2",
          receiverName: "Suraj Muhammad",
          receiverPic: "",
          amount: 12000,
          refid: "TXN002",
          narration: "Invoice payment",
          date: "2024-09-15T14:30:00.000Z",
          createdAt: "2024-09-15T14:30:00.000Z",
          updatedAt: "2024-09-15T14:30:00.000Z",
          isCredit: true,
        },
        {
          id: 3,
          userid: "2",
          sender: "2",
          senderName: "Suraj Muhammad",
          senderPic: "",
          receiver: "user2",
          receiverName: "Salma Gambo",
          receiverPic: "",
          amount: 3000,
          refid: "TXN003",
          narration: "Gift",
          date: "2024-10-01T09:00:00.000Z",
          createdAt: "2024-10-01T09:00:00.000Z",
          updatedAt: "2024-10-01T09:00:00.000Z",
          isCredit: false,
        },
        {
          id: 4,
          userid: "2",
          sender: "user3",
          senderName: "Muhammad Ali",
          senderPic: "",
          receiver: "2",
          receiverName: "Suraj Muhammad",
          receiverPic: "",
          amount: 15000,
          refid: "TXN004",
          narration: "Loan repayment",
          date: "2024-10-10T11:45:00.000Z",
          createdAt: "2024-10-10T11:45:00.000Z",
          updatedAt: "2024-10-10T11:45:00.000Z",
          isCredit: true,
        },
        {
          id: 5,
          userid: "2",
          sender: "2",
          senderName: "Suraj Muhammad",
          senderPic: "",
          receiver: "user2",
          receiverName: "Salma Gambo",
          receiverPic: "",
          amount: 7000,
          refid: "TXN005",
          narration: "Dinner payment",
          date: "2024-10-20T19:00:00.000Z",
          createdAt: "2024-10-20T19:00:00.000Z",
          updatedAt: "2024-10-20T19:00:00.000Z",
          isCredit: false,
        },
        {
          id: 6,
          userid: "2",
          sender: "user3",
          senderName: "Muhammad Ali",
          senderPic: "",
          receiver: "2",
          receiverName: "Suraj Muhammad",
          receiverPic: "",
          amount: 20000,
          refid: "TXN006",
          narration: "Project funding",
          date: "2024-11-01T08:00:00.000Z",
          createdAt: "2024-11-01T08:00:00.000Z",
          updatedAt: "2024-11-01T08:00:00.000Z",
          isCredit: false,
        },
        {
          id: 7,
          userid: "2",
          sender: "2",
          senderName: "Suraj Muhammad",
          senderPic: "",
          receiver: "user2",
          receiverName: "Salma Gambo",
          receiverPic: "",
          amount: 4000,
          refid: "TXN007",
          narration: "Utility bill",
          date: "2024-11-10T12:00:00.000Z",
          createdAt: "2024-11-10T12:00:00.000Z",
          updatedAt: "2024-11-10T12:00:00.000Z",
          isCredit: false,
        },
        {
          id: 8,
          userid: "2",
          sender: "user3",
          senderName: "Muhammad Ali",
          senderPic: "",
          receiver: "2",
          receiverName: "Suraj Muhammad",
          receiverPic: "",
          amount: 5000,
          refid: "TXN008",
          narration: "Freelance work",
          date: "2024-11-15T16:00:00.000Z",
          createdAt: "2024-11-15T16:00:00.000Z",
          updatedAt: "2024-11-15T16:00:00.000Z",
          isCredit: true,
        },
        {
          id: 9,
          userid: "2",
          sender: "2",
          senderName: "Suraj Muhammad",
          senderPic: "",
          receiver: "user4",
          receiverName: "Aisha Bello",
          receiverPic: "",
          amount: 2500,
          refid: "TXN009",
          narration: "Grocery shopping",
          date: "2024-09-20T10:00:00.000Z",
          createdAt: "2024-09-20T10:00:00.000Z",
          updatedAt: "2024-09-20T10:00:00.000Z",
          isCredit: false,
        },
        {
          id: 10,
          userid: "2",
          sender: "user5",
          senderName: "John Doe",
          senderPic: "",
          receiver: "2",
          receiverName: "Suraj Muhammad",
          receiverPic: "",
          amount: 8000,
          refid: "TXN010",
          narration: "Consulting fee",
          date: "2024-09-25T14:00:00.000Z",
          createdAt: "2024-09-25T14:00:00.000Z",
          updatedAt: "2024-09-25T14:00:00.000Z",
          isCredit: true,
        },
        {
          id: 11,
          userid: "2",
          sender: "2",
          senderName: "Suraj Muhammad",
          senderPic: "",
          receiver: "user6",
          receiverName: "Fatima Yusuf",
          receiverPic: "",
          amount: 6000,
          refid: "TXN011",
          narration: "Rent payment",
          date: "2024-10-05T09:00:00.000Z",
          createdAt: "2024-10-05T09:00:00.000Z",
          updatedAt: "2024-10-05T09:00:00.000Z",
          isCredit: false,
        },
        {
          id: 12,
          userid: "2",
          sender: "user7",
          senderName: "Ahmed Suleiman",
          senderPic: "",
          receiver: "2",
          receiverName: "Suraj Muhammad",
          receiverPic: "",
          amount: 15000,
          refid: "TXN012",
          narration: "Salary",
          date: "2024-10-15T17:00:00.000Z",
          createdAt: "2024-10-15T17:00:00.000Z",
          updatedAt: "2024-10-15T17:00:00.000Z",
          isCredit: true,
        },
        {
          id: 13,
          userid: "2",
          sender: "2",
          senderName: "Suraj Muhammad",
          senderPic: "",
          receiver: "user8",
          receiverName: "Zainab Usman",
          receiverPic: "",
          amount: 4500,
          refid: "TXN013",
          narration: "Utility bill",
          date: "2024-10-25T11:00:00.000Z",
          createdAt: "2024-10-25T11:00:00.000Z",
          updatedAt: "2024-10-25T11:00:00.000Z",
          isCredit: false,
        },
        {
          id: 14,
          userid: "2",
          sender: "user9",
          senderName: "Maryam Abubakar",
          senderPic: "",
          receiver: "2",
          receiverName: "Suraj Muhammad",
          receiverPic: "",
          amount: 10000,
          refid: "TXN014",
          narration: "Freelance project",
          date: "2024-11-05T13:00:00.000Z",
          createdAt: "2024-11-05T13:00:00.000Z",
          updatedAt: "2024-11-05T13:00:00.000Z",
          isCredit: true,
        },
        {
          id: 15,
          userid: "2",
          sender: "2",
          senderName: "Suraj Muhammad",
          senderPic: "",
          receiver: "user10",
          receiverName: "Khadija Ibrahim",
          receiverPic: "",
          amount: 3000,
          refid: "TXN015",
          narration: "Gift",
          date: "2024-11-10T15:00:00.000Z",
          createdAt: "2024-11-10T15:00:00.000Z",
          updatedAt: "2024-11-10T15:00:00.000Z",
          isCredit: false,
        },
        {
          id: 16,
          userid: "2",
          sender: "user11",
          senderName: "Abdullahi Musa",
          senderPic: "",
          receiver: "2",
          receiverName: "Suraj Muhammad",
          receiverPic: "",
          amount: 7000,
          refid: "TXN016",
          narration: "Loan repayment",
          date: "2024-11-15T18:00:00.000Z",
          createdAt: "2024-11-15T18:00:00.000Z",
          updatedAt: "2024-11-15T18:00:00.000Z",
          isCredit: true,
        },
        {
          id: 17,
          userid: "2",
          sender: "2",
          senderName: "Suraj Muhammad",
          senderPic: "",
          receiver: "user12",
          receiverName: "Hassan Abdullahi",
          receiverPic: "",
          amount: 5000,
          refid: "TXN017",
          narration: "Charity donation",
          date: "2024-11-17T10:00:00.000Z",
          createdAt: "2024-11-17T10:00:00.000Z",
          updatedAt: "2024-11-17T10:00:00.000Z",
          isCredit: false,
        },
      ],
      setTransactions: (transactions: Transaction[]) => {
        set({ transactions });
      },
      addTransaction: (transaction: Transaction) => {
        const transactions = get().transactions;
        set(() => ({
          transactions: [transaction, ...transactions],
        }));
      },
      deleteTransaction: (id: number) => {
        const transactions = get().transactions;
        const filteredTransactions = transactions.filter(
          (transaction: Transaction) => transaction.id !== id
        );
        set({ transactions: filteredTransactions });
        toast.success("Transaction deleted successfully");
      },
      clearAll: () => {
        set({
          transactions: [],
        });
      },
    }),
    {
      name: "echopay-transactions-storage",
      storage: createJSONStorage(() => localStorage),
    }
  )
);

export default useTransaction;
